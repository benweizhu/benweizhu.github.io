
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>NO END FOR LEARNING</title>
  <meta name="author" content="ZHU Benwei">

  
  <meta name="description" content="一个图标的生命周期（工作流程） 图标库(选择阶段) -> 图标使用（开发阶段） 图标设计（设计阶段） -> 图标导出（沟通阶段） -> 图标使用（开发阶段） 第一种方式是一般是小公司或者独立开发者的工作流程。而对于大型组织或公司，因为拥有更完善的团队和资源，一般是第二种方式， &hellip;&#8221;>
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://benweizhu.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="NO END FOR LEARNING" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">NO END FOR LEARNING</a></h1>
  
    <h2>Writing blog if you feel tired | 学海无涯 苦写博客</h2>
  
</hgroup>
</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="benweizhu.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/04/03/svg-and-icon-font/">前端不止系列 - 请告诉我，你要什么样的图标</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-04-03T09:47:12+08:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2017</span></span> <span class='time'>9:47 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>一个图标的生命周期（工作流程）</h4>

<p><img src="/images/svg/icomoon-svg.png" width="265" title="图标的生命周期" alt="Alt text" />   <br/>
图标库(选择阶段) -> 图标使用（开发阶段）</p>

<p><img src="/images/svg/ai-ps-svg.png" width="400" title="图标的生命周期" alt="Alt text" />   <br/>
图标设计（设计阶段） -> 图标导出（沟通阶段） -> 图标使用（开发阶段）</p>

<p>第一种方式是一般是小公司或者独立开发者的工作流程。而对于大型组织或公司，因为拥有更完善的团队和资源，一般是第二种方式，能够获得更多自主权和建立企业VI（Visual Identity，企业视觉识别）的能力。</p>

<p>但无论是哪种方式，都包括两个角色：设计师和Web开发，只是第一种工作方式中，设计师是不可见的。</p>

<h4>图标的设计和使用</h4>

<p>设计阶段通常是由不了解Web开发的设计师们来完成的，他们会根据产品的需要，绘画出满足需求的图标。</p>

<p><img src="/images/svg/ThoughtWorksContactUSIcon.jpg" width="400" title="ThoughtWorksContactUSIcon" alt="Alt text" />  <br/>
ThoughtWorks官网Contact with us图标</p>

<p>然后交给Web开发人员使用，为什么要先介绍图标的使用，而一笔跳过导出过程呢？原因很简单，因为我们需要先知道服务的对象是谁，才知道如何正确的为它服务。</p>

<h5>常见的三种使用图标的方式</h5>

<p>1.使用图片</p>

<p>直接将设计师画好的图标，以PNG格式的图片一个个分离导出，这是最直观的图标打包方式。</p>

<p><img src="/images/svg/taobao.png" width="300" title="iconfont cn taobao icon" alt="Alt text" /> <br/>
1688DPL中台图标库</p>

<p>它的优点是：（1）能够使用彩色的图标（2）能够支持大部分浏览器；缺点是：（1）图标大小是固定的（不能根据场景自由缩放）（2）Retina屏幕需要两倍图。</p>

<p>开发人员拿到这样的图标，通常会需要先合成为一张图片，以方便制作<a href="https://css-tricks.com/css-sprites/" title="雪碧图">雪碧图</a>，这个过程可以由开发人员自己完成，也可以由设计师（设计师可以根据源文件中心导出一张包含所有图标的PNG文件）。</p>

<p>制作雪碧图的工具有很多，我比较常用的在线雪碧图工具是：<a href="http://www.spritecow.com/" title="Sprite Cow">Sprite Cow</a>，或者NodeJS平台下的构建工具插件，如：<a href="https://github.com/mixtur/webpack-spritesmith" title="webpack-spritesmith">webpack-spritesmith</a>。</p>

<p>2.直接使用svg</p>

<p>使用SVG（可缩放矢量图形），W3C标准，<strong>最看好的Web端图形解决方案</strong>。它能提供如裁剪路径、Alpha通道、滤镜效果等复杂渲染能力，具备传统图片没有的矢量功能，还可以被记事本等阅读器、搜索引擎访问。</p>

<p>设计师可以轻松的在设计绘图软件（AI，PS）的帮助下导出SVG格式的图标/图片。</p>

<p>但目前，国内svg还并没有被非常广泛的使用，原因是它的兼容性，不能够很好的兼容旧的IE版本和一些Android原生浏览器。</p>

<p><img src="/images/svg/svg-support.png" width="400" title="svg support" alt="Alt text" />  <br/>
Can I use svg?</p>

<p><img src="/images/svg/baidu.jpg" width="400" title="baidu tong ji" alt="Alt text" />    <br/>
百度2017年前三个月的浏览器使用统计，目前国内还有超过20%的用户仍在使用IE8，9甚至是IE7。</p>

<p>3.IconFont</p>

<p>IconFont是目前最为流行的图标解决方案，顾名思义，它就是字体文件，你可以用任何一个字体编辑工具打开它，如果你打开某一个查看，你会发现它就是一些路径，这些路径可以用AI，PS，Sketch等软件来绘制。</p>

<p><img src="/images/svg/font-awesome.png" width="300" title="font awesome" alt="Alt text" /></p>

<p>IconFont的优点在于能够用CSS控制样式，无限缩放而不失真，支持IE7+，兼顾屏幕阅读器，不过缺点是不能支持彩色（拥有多种颜色的图标）图标。获得IconFont的方式也很简单，设计师将图标通过AI/PS转成SVG文件，然后由开发人员通过工具（在线或者本地）转换为IconFont，比如：国外的<a href="https://icomoon.io/" title="icomoon.io">icomoon.io</a>，国内的<a href="http://iconfont.cn/" title="iconfont.cn">iconfont.cn</a>，开源构建工具插件有<a href="https://github.com/nfroidure/gulp-iconfont" title="gulp-iconfont">gulp-iconfont</a>等等。</p>

<h4>产生适合Web开发的图标</h4>

<p>“产生适合Web开发的图标”是我们今天要关注的重点。</p>

<p>1.使用图片的方式</p>

<p>如果开发人员直接使用图片，则相对简单，设计师只需要针对普通屏幕和Retina屏幕准备两套图（单倍图和两倍图）。</p>

<p>以国内某著名的中文小说阅读网站为例，会针对不同的设备使用不同倍数的logo图片，以保证在如Retina屏幕下的清晰度。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.logo-wrap</span> <span class="nc">.logo</span> <span class="nt">a</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">display</span><span class="o">:</span> <span class="k">block</span><span class="p">;</span>
</span><span class='line'>    <span class="k">width</span><span class="o">:</span> <span class="m">219px</span><span class="p">;</span>
</span><span class='line'>    <span class="k">height</span><span class="o">:</span> <span class="m">52px</span><span class="p">;</span>
</span><span class='line'>    <span class="k">background</span><span class="o">:</span> <span class="sx">url(/qd/images/logo.0.2.png)</span> <span class="k">no-repeat</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@media</span> <span class="o">(</span><span class="nt">min--moz-device-pixel-ratio</span><span class="nd">:1</span><span class="nc">.3</span><span class="o">),(</span><span class="nt">-o-min-device-pixel-ratio</span><span class="o">:</span> <span class="nt">2</span><span class="nc">.6</span> <span class="o">/</span> <span class="nt">2</span><span class="o">),(</span><span class="nt">-webkit-min-device-pixel-ratio</span><span class="nd">:1</span><span class="nc">.3</span><span class="o">),(</span><span class="nt">min-device-pixel-ratio</span><span class="nd">:1</span><span class="nc">.3</span><span class="o">),(</span><span class="nt">min-resolution</span><span class="nd">:1</span><span class="nc">.3dppx</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="nc">.logo-wrap</span> <span class="nc">.logo</span> <span class="nt">a</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">background</span><span class="o">:</span> <span class="sx">url(/qd/images/logo3x.0.2.png)</span> <span class="k">no-repeat</span><span class="p">;</span>
</span><span class='line'>      <span class="k">background-repeat</span><span class="o">:</span> <span class="k">no-repeat</span><span class="p">;</span>
</span><span class='line'>      <span class="k">background</span><span class="o">-</span><span class="k">size</span><span class="o">:</span> <span class="m">217px</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>2.使用SVG</p>

<p>关于转换成SVG，这里就要引荐一下Sara Soueidan在Generate London 2015 Conference上的演讲<a href="https://www.youtube.com/watch?v=q4QI9iOeyPo" title="《Sara Soueidan: SVG for Web Designers (and Developers)》">《Sara Soueidan: SVG for Web Designers (and Developers)》</a>（YouTube视频需要翻墙），如果不方便，Sara Soueidan有一篇博客<a href="https://sarasoueidan.com/blog/svg-tips-for-designers/" title="《Tips for Creating and Exporting Better SVGs for the Web》">《Tips for Creating and Exporting Better SVGs for the Web》</a>更详细的讲解关于SVG导出的内容，当然，还有一篇国内的翻译文章<a href="http://www.w3cplus.com/svg/svg-tips-for-designers.html" title="《创建和导出SVG的技巧》">《创建和导出SVG的技巧》</a>，最后在推荐一篇Adobe工程师michael chaize写的关于AI导出SVG的文章<a href="http://creativedroplets.com/export-svg-for-the-web-with-illustrator-cc/" title="《Export SVG for the web with Illustrator CC》">《Export SVG for the web with Illustrator CC》</a>。</p>

<p>不过，我觉得看视频更直观，顺便领略一下这位优秀的 <strong>阿拉伯女性前端开发工程师（兼自由作家和演讲人）</strong> 的风采。</p>

<p>博客和视频中谈到了多个点导出SVG需要注意的地方，篇幅限制，这里简单描述三个tip：</p>

<p><strong>（1）选择适合绘画的画板</strong>。</p>

<p>你有在网页上嵌入过SVG吗，给它指定一个高度和宽度，然后发现它其实比你指定的尺寸要小？开发人员常常会遇到这样的问题。</p>

<p>大多数情况下，这是因为SVG视窗中有一定大小的白色空白的空间。视窗是按照你在样式表中指定的尺寸显示的，但是它里面有额外的空白——在图形周围——使得你的图片看起来好像“缩水”了，因为这块空白是占空间的，在视窗里面。为了避免这种情况，你需要确保你的画板是刚刚好放下里面的图像的，不要大太多。</p>

<p>画板的尺寸就是导出的SVG的视窗的尺寸，所有画板上的空白都会最终变成视窗中的白色空白。</p>

<p><img src="/images/svg/fit-artboard.png" width="400" title="fit artboard" alt="Alt text" /></p>

<p><strong>（2）选择合适的导出选项</strong></p>

<p><img src="/images/svg/export-options.png" width="400" title="保存" alt="Alt text" />   <br/>
上面的图片中展示的选项是推荐的生成适合Web使用的SVG的。如果你不想使用Web字体，可以选择把文本转换成轮廓。</p>

<p><img src="/images/svg/output-fewer.png" width="400" title="output-fewer" alt="Alt text" /><br/>
如果SVG中包含大量的文字，这个选项output fewer tspan elements可以很大程度降低svg的大小。</p>

<p><strong>（3）优化SVG</strong></p>

<p>通常是建议在把SVG从图形编辑器中导出后，再用单独的优化工具来进行优化。比如：删除无用Comments和Metadata，简化代码，简化单个路径等。推荐的第三方工具：NodeJS工具<a href="https://jakearchibald.github.io/svgomg/" title="svgomg">svgomg</a>，AI插件<a href="https://github.com/davidderaedt/SVG-NOW" title="SVG-NOW">SVG-NOW</a>，Sketch插件<a href="https://github.com/BohemianCoding/svgo-compressor" title="Svgo-compressor">Svgo-compressor</a>等，请参考Sara Soueidan的文章<a href="https://sarasoueidan.com/blog/svgo-tools/" title="《Useful SVGO[ptimization] Tools》">《Useful SVGO[ptimization] Tools》</a>。</p>

<p><img src="/images/svg/svgomg.png" width="400" title="优化svg" alt="Alt text" /></p>

<p>3.IconFont</p>

<p>前面提到IconFont一般是由SVG通过工具转换而来，而如果开发最终需要使用IconFont展示图标，则对于导出的SVG有一些特殊要求。我在本文的前面一小节，已经介绍了几款IconFont的转换工具，每一款工具其实都有详细的文档说明SVG绘制的规则，尽管不尽相同，但有一些基本原则是一致的：</p>

<p>（1）将文字转换为路径  <br/>
（2）不可以使用图片（字体只是路径） <br/>
（3）修剪画板（trimming to art boundaries）（前面已经介绍过） <br/>
（4）将描边转化为闭合图形 <br/>
（5）简化无用的节点  <br/>
等等</p>

<p>更多关于IconFont的绘画规则，请参考：<a href="http://iconfont.cn/plus/help/detail?helptype=draw" title="Iconfont.cn文档">Iconfont.cn文档</a>，<a href="https://icomoon.io/#docs/importing" title="Icomoon文档">Icomoon文档</a>，<a href="https://github.com/nfroidure/gulp-iconfont#preparing-svgs" title="gulp-iconfont文档">gulp-iconfont文档</a>，<a href="https://github.com/fontello/fontello/wiki/How-to-use-custom-images" title="fontello文档">fontello文档</a>。</p>

<h4>尽早的沟通</h4>

<p>无论是开发还是设计师，最重要的还是沟通，借用Sara Soueidan的一句“设计师和开发者应该成为好朋友”。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/03/25/css-retina-image/">前端不止系列 - Retina屏幕下两倍图</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-03-25T16:40:09+08:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>4:40 pm</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>所见不一定即所得</h3>

<blockquote><p>眼睛是心灵的窗户，也是蒙蔽你的一种途径。</p></blockquote>

<p>假设，我给你一张图片，你觉得肉眼可以观察到全部的细节吗？</p>

<h3>屏幕上一张清晰的图片</h3>

<p>肉眼在屏幕上看到图片的清晰度由三个因素决定，一是图片像素本身是否精细，二是屏幕分辨率，三是屏幕大小。</p>

<p>我们来逐步分析它们之间的关系：</p>

<h4>屏幕分辨率</h4>

<p>屏幕分辨率也就是设备分辨率，设备像素，它是物理的像素，比如，新的iPhone7，屏幕分辨率是1334 x 750像素分辨率，326 ppi。</p>

<p><img src="/images/iphone7-screen.png" width="400" title="iPhone7分辨率" alt="Alt text" /></p>

<h4>图像大小</h4>

<p>如果你学过《数字图像处理》这门课，那你对下面的解释就是非常熟悉了。</p>

<p>位图是由像素（Pixel）组成的，像素是位图最小的信息单元，存储在图像栅格中。每个像素都具有特定的位置和颜色值。按从左到右、从上到下的顺序来记录图像中每一个像素的信息，如：像素在屏幕上的位置、像素的颜色等。位图图像质量是由单位长度内像素的多少来决定的。单位长度内像素越多，分辨率越高，图像的效果越好。</p>

<p><img src="/images/tw-logo.png" width="200" title="ThoughtWorks Logo" alt="Alt text" /></p>

<p>假设，以上这个logo的图像大小是1334 x 750像素和iPhone7屏幕分辨率一样，那么,一位图像素对应的就是一个设备像素，这就是会是一个完全保真的显示。因为一个位置像素不能进一步分裂，我想这一点应该大家非常容易理解，也就是一个萝卜一个坑。</p>

<h4>屏幕分辨率和屏幕尺寸</h4>

<p><img src="/images/resolution.png" width="400" title="Windows分辨率" alt="Alt text" /></p>

<p>相信大部分人对上面这个设置肯定特别熟悉，有些人可能对XP，甚至98系统的样式更熟悉（一不小心暴露了年龄），在Windows系统下，提高屏幕分辨率一般都需要提高屏幕尺寸。</p>

<p>因为在固定屏幕的情况下，提高屏幕分辨率（如上图），图像和文字显示目标会相应缩小，原因是系统并不会自动根据屏幕尺寸和分辨率关系相应的调整文字和图标的大小，这是Windows系统自身的行为。</p>

<p>我相信，如果家里有年长的人使用电脑，肯定屏幕分辨率调的很低，因为这样文字和图标才会比较大，我家06年买的台式机就是这样。</p>

<p>也因此，我们很容易有一个错觉，那就是屏幕越大，分辨率就能越大（在单位面积内像素数量固定的情况下，尺寸越大，单个屏幕拥有的像素就越多，分辨率自然就越大）。</p>

<p><strong>直到，苹果Retina屏幕的出现，原来小屏幕也可以拥有大分辨率。</strong></p>

<h4>PPI的概念</h4>

<p>PPI，像素密度，即每英寸所拥有的像素数目（比如：上面iPhone 7的PPI是326），PPI数值越高，代表显示屏能够以越高的密度显示图像，画面的细节就会越丰富。</p>

<p>以Retina屏幕为例，它并不是像普通显示器那样通过增大尺寸来增加分辨率，而是靠提升屏幕单位面积内的像素数量，即像素密度来提升分辨率，这样就有了高像素密度屏幕。</p>

<p>根据上面的分析，分辨率提升了，那么图标和文字尺寸就会变小，但是Mac的操作系统不同，它自动采取相应的模式（如Mac下的HiDPI）进行适配，将缩小后的字体（苹果一直采用矢量字体）和图标重新放大，这样苹果用了更多的像素数来显示同样的内容，所以显示尺寸仍然不变。</p>

<p>苹果将“高像素密度屏幕”的概念营销出一个专业的术语“Retina”，将其称为双密度显示，声称人类的肉眼将无法区分单个像素。</p>

<p>当一个显示屏像素密度超过300ppi时，人眼就无法区分出单独的像素。这也是讲：显示设备清晰度已达到人视网膜可分辨像素的极限。因此，行动电话显示器的像素密度达到或高于300ppi就不会再出现颗粒感，而手持平板类电器显示器的像素密度达到或高于260ppi就不会再出现颗粒感，苹果电脑Mac的Retina显示器像素密度只要超过200ppi就无法区分出单独的像素。</p>

<p><img src="/images/retina-display.jpg" width="500" title="retina-display" alt="Alt text" /></p>

<p>好，说了这么多，都是谈屏幕的问题，貌似和前端开发没有什么关系，我又不是要买新手机（呵呵），那么现在，我们现在来谈谈前端的问题。</p>

<h4>Web中的像素（CSS像素）</h4>

<p>CSS像素是一个抽象概念，设备无关像素，简称-“DIPS”，device-independent像素，主要使用在浏览器上，用来精确的度量（确定）Web页面上的内容。</p>

<p>在标准情况下一个CSS像素对应一个设备像素。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.box</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">width</span><span class="o">:</span> <span class="m">200px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">height</span><span class="o">:</span> <span class="m">300px</span><span class="p">;</span>
</span><span class='line'>  <span class="k">font-size</span><span class="o">:</span> <span class="m">12px</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>上面的代码，将会在显示屏设备上绘制一个200x300像素的盒子，在标准屏幕下，它占据的就是200x300设备像素。但是在Retina屏幕下，相同的div却使用了400x600设备像素，保持相同的物理尺寸显示，导致每个像素点实际上有4倍的普通像素点。</p>

<p><img src="/images/retina-web.jpg" width="500" title="retina-web" alt="Alt text" /></p>

<p>对于图片来说也是如此：</p>

<p><img src="/images/retina-web-bitmap.jpg" width="500" title="retina-web bitmap" alt="Alt text" /></p>

<p>这个时候，屏幕会怎么处理呢？其实，有点类似图像软件的放大图片功能，采用自有的算法（图像处理算法）计算放大方式。只不过，这里是苹果Retina屏幕的计算方法，一个CSS像素点实际分成了四个，造成颜色肯定会存在偏差（非全保真的显示），于是，我们看上去就变得模糊了（特别是图片，非常的明显）。</p>

<p>开发当中遇到这样的事情，我们应该怎么处理呢？这时，我们需要引出devicePixelRatio的概念。</p>

<h5>devicePixelRatio设备像素比</h5>

<p>window.devicePixelRatio是设备上物理像素和设备独立像素(device-independent pixels (dips))的比例。</p>

<p>公式表示就是：window.devicePixelRatio = 物理像素 / dips</p>

<ul>
<li>普通密度桌面显示屏的devicePixelRatio=1</li>
<li>高密度桌面显示屏(Mac Retina)的devicePixelRatio=2</li>
<li>主流手机显示屏的devicePixelRatio=2或3</li>
</ul>


<p>举例说明，一张100x100的图片，通过CSS设置它{ width:100px; height:100px }。在普通密度桌面显示屏的电脑上打开，没有什么问题，但假设在手机/或者Retina屏幕的Mac，按照逻辑分辨率来渲染，他们的devicePixelRatio=2，那么就相当于拿4个物理像素来描绘1个电子像素。这等于拿一个2倍的放大镜去看图片，图片可能因此变得模糊。</p>

<p><img src="/images/devicePixelRatio.png" title="devicePixelRatio" alt="Alt text" /></p>

<h3>代码如何解决呢？</h3>

<p>原理我们明白了，那么从代码层面，我们应该如何实现呢？</p>

<p>一个常见的做法是把图片换成200x200的，CSS宽高不变，仍然是{ width:100px; height:100px }，这样，CSS宽高换算成物理像素是200x200，图片也是200x200，就不会变糊了。可以采用媒体查询和JS操作的方式</p>

<h4>CSS Media Queries</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nf">#element</span> <span class="p">{</span> <span class="k">background-image</span><span class="o">:</span> <span class="sx">url(&#39;hires.png&#39;)</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@media</span> <span class="nt">only</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-device-pixel-ratio</span><span class="o">:</span> <span class="nt">2</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nf">#element</span> <span class="p">{</span> <span class="k">background-image</span><span class="o">:</span> <span class="sx">url(&#39;hires@2x.png&#39;)</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@media</span> <span class="nt">only</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-device-pixel-ratio</span><span class="o">:</span> <span class="nt">3</span><span class="o">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nf">#element</span> <span class="p">{</span> <span class="k">background-image</span><span class="o">:</span> <span class="sx">url(&#39;hires@3x.png&#39;)</span><span class="p">;</span> <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h4>JS查询</h4>

<p><strong>retinajs库</strong></p>

<p><a href="http://imulus.github.io/retinajs/">http://imulus.github.io/retinajs/</a></p>

<p><img src="/images/caniuserdevicePixelRatio.png" title="devicePixelRatio" alt="Alt text" /></p>

<h3>是不是适配Retina屏幕所有的图片都需要切换呢？</h3>

<p>不是，一般情况下，不需要针对网站上的所有图片都提供两个版本（非Retina屏幕和Retina屏幕），大部分图片缩放并不会太多的影响用户的体验。</p>

<p>常常需要被处理的图片有：网站的logo、彩色图片图标，因为他们的图像大小都偏小，在Retina上物理像素放两倍显示就会出现模糊情况，这个时候，你就需要通过媒体查询或者JS操作来替换图片。</p>

<p><em>最后：眼睛是心灵的窗户，也是蒙蔽你的一种途径，带上知识的眼镜，将世界看个清楚</em></p>

<p>参考资料：  <br/>
1. <a href="http://www.w3cplus.com/css/towards-retina-web.html">http://www.w3cplus.com/css/towards-retina-web.html</a> <br/>
2. <a href="http://www.jianshu.com/p/bb76c606f0b4">http://www.jianshu.com/p/bb76c606f0b4</a>  <br/>
3. <a href="https://developer.mozilla.org/zh-CN/docs/Mobile/Viewport_meta_tag">https://developer.mozilla.org/zh-CN/docs/Mobile/Viewport_meta_tag</a> <br/>
4. <a href="http://caniuse.com/#search=devicePixelRatio">http://caniuse.com/#search=devicePixelRatio</a>  <br/>
5. <a href="https://www.web-tinker.com/article/20590.html">https://www.web-tinker.com/article/20590.html</a></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1 style="margin-left: 5px;">About Me</h1>
  <div style="margin-left: 8px;">Working in <a href="https://www.thoughtworks.com/" style="text-decoration: blink;font-weight: bolder;">ThoughtWorks</a> Wuhan</div>
  <div style="margin-left: 8px;margin-top: 10px;">A Java/RoR/NodeJS-FE/Full Stack Developer</div>
  <div style="margin-left: 8px;margin-top: 10px;">A Gradle Plugin Contributor</div>
  <div style="margin-top: 10px;"><a href='http://book.douban.com/subject/26609447/' target="_blank" style="text-decoration: blink;font-weight: bolder;">《实战Gradle》</a>译者之一</div>
  <div style="margin-left: 8px;;margin-top: 10px;">计算机应用技术学术型硕士-<span style="font-weight: bold;">信息安全方向</span></div>
  <div style="margin-top: 10px;margin-left: 8px;">关注：Gradle，Spring，前端开发，自动化构建，自动化测试，Devops，信息安全</div>
  <div style="margin-top: 10px;margin-left: 8px;">我正在写的书：<a href='https://benweizhu.gitbooks.io/gradle-best-practice/content/' target="_blank" style="text-decoration: blink;font-weight: bolder;">《Gradle最佳实践》</a></div>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/04/03/svg-and-icon-font/">前端不止系列 - 请告诉我，你要什么样的图标</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/03/25/css-retina-image/">前端不止系列 - Retina屏幕下两倍图</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/01/react-step-by-step-2/">一步一步做React(二) - CSS Modules</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/17/react-step-by-step-1/">一步一步做React(一) - Hello React</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/19/style-guide-driven-development/">你听说过“风格指南驱动开发”吗？</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'benweizhu',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
  <div>
    <h1>Currently Working On</h1>
    <div>
      <span>relations-back-end</span>
      <img src="https://travis-ci.org/benweizhu/relations-back-end.svg?branch=master" style=" vertical-align: middle;margin-left: 11%;">
    </div>
    <br/>
    <div>
      <span>relations-front-end</span>
      <img src="https://travis-ci.org/benweizhu/relations-front-end.svg?branch=master" style=" vertical-align: middle;margin-left: 10%;">
    </div>
    <br/>
    <div>
      <span>gradle-plugin-database</span>
      <img src="https://travis-ci.org/benweizhu/gradle-plugin-database.svg?branch=master" style=" vertical-align: middle;">
    </div>
  </div>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - ZHU Benwei -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
